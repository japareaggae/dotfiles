#!/bin/bash
# TODO: Things break horribly when filenames have spaces

if [[ ! $@ ]]; then
	echo "usage: gif2webm [files]"
	echo "output files will be placed on the same folder as the originals"
fi

for file in $@; do
	FILEPATH="$(realpath "$file")"
	echo $FILEPATH

	if [[ $(file --mime-type -b "$FILEPATH") = 'image/gif' ]]; then
		ffmpeg -i "$FILEPATH" -c:v libvpx -crf 4 -b:v 1M -threads $(nproc) "${FILEPATH/.gif/.webm}"
	else
		echo "error: $FILEPATH is not a gif"
	fi
done

