#!/bin/sh
# Written by Renan Guilherme <japareaggae@gmail.com>
# Released under the public domain <http://unlicense.org/UNLICENSE>

# This is where you store your backups.
REMOTE_STABLE="$HOME/Dropbox/Vidya/Starbound/player-stable"
REMOTE_UNSTABLE="$HOME/Dropbox/Vidya/Starbound/player-unstable"

case $(uname -m) in
	"x86_64") ARCH="linux64" ;;
	"i686") ARCH="linux32" ;;
esac
# This is where Starbound stores it's player data.
LOCAL_STABLE="$HOME/.local/share/Steam/steamapps/common/Starbound/$ARCH/player"
LOCAL_UNSTABLE="$HOME/.local/share/Steam/steamapps/common/Starbound/storage_unstable/player"

_usage(){
cat << EOF
Usage: $(basename $0) (stable | unstable) (import | export)

Synchronizes Starbound player data between two folders using rsync.
This script is not affiliated with Chucklefish.

  import     Copies from REMOTE into LOCAL.
  export     Copies from LOCAL into REMOTE.

Stable
Remote: $REMOTE_STABLE
Local:  $LOCAL_STABLE

Unstable
Remote: $REMOTE_UNSTABLE
Local:  $LOCAL_UNSTABLE
EOF
}

if [ ! $(which rsync) ]; then
	echo "E: You need to install rsync before using starbinder"
	exit 1
fi

case $1 in
	stable)
		LOCAL=$LOCAL_STABLE
		REMOTE=$REMOTE_STABLE ;;
	unstable)
		LOCAL=$LOCAL_UNSTABLE
		REMOTE=$REMOTE_UNSTABLE ;;
	*) _usage; exit ;;
esac

case $2 in
	export) rsync -avzu $LOCAL/ $REMOTE;;
	import) rsync -avzu $REMOTE/ $LOCAL;;
	check)
		echo "=== LOCAL ==="
		ls -l $LOCAL
		echo "=== REMOTE ==="
		ls -l $REMOTE
		;;
esac

